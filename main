var harvester = require('harvester');
var builder = require("builder");
var guard = require('guard');
var spawnBuild = require('spawn');

const HARVESTER = 'h';
const BUILDER = 'b';
const GUARD = 'g';



const buildOrder = [
    {t:type_worker,next:1},
    {t:type_worker,next:2},
    {t:type_worker,next:3},
    {t:type_builder,next:4},
    {t:type_slow_guard,next:5},
    {t:type_slow_guard,next:6},
    {t:type_slow_guard,next:7},
    {t:type_slow_guard,next:4}
];
console.log("loaded OK");

for(var sp_name in Game.spawns) {
  var spawn = Game.spawns[sp_name];
  spawnBuild.setup(spawn);
}

module.exports.loop = function () {
  //tidy up dead creeps
  for(var i in Memory.creeps) {
    if(!Game.creeps[i]) {
      //TODO: identify where they came from and regenerate them
      delete Memory.creeps[i];
    }
  }

	for(var name in Game.creeps) {
		var creep = Game.creeps[name];
    switch(creep.memory.role){
      case HARVESTER:
  	    harvester(creep);
  	    break;
      case BUILDER:
        builder(creep);
        break;
      case GUARD:
        guard(creep);
        break;
      default:
        console.log("unrecognised creep type: "+creep.memory.role);
    }
	}
};
