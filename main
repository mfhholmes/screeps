var harvester = require('harvester');
var builder = require("builder");
var guard = require('guard');
var spawnBuild = require('spawn');

const HARVESTER = 'h';
const BUILDER = 'b';
const GUARD = 'g';




for(var sp_name in Game.spawns) {
  var spawn = Game.spawns[sp_name];
  spawnBuild.setup(spawn);
  spawnBuild.checkBuild(spawn);
}
console.log("loaded OK");

module.exports.loop = function () {
  //tidy up dead creeps
  for(var i in Memory.creeps) {
    if(!Game.creeps[i]) {
      //TODO: identify where they came from and regenerate them
      delete Memory.creeps[i];
    }
  }

	for(var name in Game.creeps) {
		var creep = Game.creeps[name];
    switch(creep.memory.role){
      case HARVESTER:
  	    harvester(creep);
  	    break;
      case BUILDER:
        builder(creep);
        break;
      case GUARD:
        guard(creep);
        break;
      default:
        console.log("unrecognised creep type: "+creep.memory.role);
    }
	}
};
